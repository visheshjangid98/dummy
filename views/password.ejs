<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<    <title>Trace Mc</title>
<link rel="icon" type="image/png" href="media/favicon.png">
<link rel="stylesheet" href="css/register.css">
</head>
<body>
    <div class="box">
        <h1 class="form_headline">Reset password</h1>
        <form class="form_box" action="/reset-submit?token=<%= token %>" method="post" novalidate>
            <input type="password" name="password" id="password" required pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$" placeholder="Password *">
            <input type="password" id="c_word" required placeholder="Confirm Password" >
        </form>
        <button class="form_submit" onclick="submit_form()">Reset password</button>
        <p class="form_more"> </p>
    </div>
    <div class="error_box hidden">
        <img src="media/svg/error.svg" alt="">
        <p id="error_msg">Something went wrong</p>
    </div>
    <script>
        function submit_form(){
            const password = document.getElementById("password").value;
            const c_pass = document.getElementById("c_word").value;
            const error = document.getElementById("error_msg"); // use getElementById instead
            const box = document.querySelector(".error_box"); // use querySelector instead
            function close(){
                setTimeout(() => {
                    box.classList.add("hidden");
                }, 2000);
            }
            if (!password) {
                error.innerText = "Password is required";
                box.classList.remove("hidden");
                close()
            }
            else if (password.length <9) {
                error.innerText = "Password is too short";
                box.classList.remove("hidden");
                close()
            }
            else if (!/[a-z]/.test(password) || !/[A-Z]/.test(password) || !/[^A-Za-z0-9]/.test(password)) {
                error.innerText = "Password should contain at least one uppercase letter, one lowercase letter, and one special character.";
                box.classList.remove("hidden");
                close()
            }
            else if (!c_pass) {
                error.innerText = "Confirm password ins required";
                box.classList.remove("hidden");
                close()
            }
            else if (password != c_pass) {
                error.innerText = "Password does't match";
                box.classList.remove("hidden");
                close()
            }
            else{
                document.querySelector(".form_box").submit()
            }
            }
        
    </script>
</body>
</html>