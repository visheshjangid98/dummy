<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trace Mc</title>
    <link rel="icon" type="image/png" href="media/favicon.png">
    <link rel="stylesheet" href="css/confirm.css">
</head>
<body>
    <main class="hero">
        <div class="hero-head">
            <h1>Confirm Purchase</h1>
        </div>
        <div class="hero-body">
            <div class="hero-body-info">
<h4><p>Pay : </p><%= price %> INR</h4>
<img src="<%= qrCodeImage %>" alt="qrcode">
<img src="media/paymentmethods.png" alt="paymentmethods">
            </div>
            <div class="hero-body-name">
                <div class="form-div">

                    <form class="form_box" action="/confirmed" method="post" novalidate>
                        <input type="text" id="Id" name="TXNId"  required placeholder="Transition ID *" >
                        <input type="text" id="cId" required placeholder="Confirm Transition ID *">
                        <input type="hidden" value="<%= orderId %>" name="orderId">
                    </form>
                    <button class="form_submit" onclick="submit_form()">Confirm</button>
                    <div class="terms-div">
                        <input type="checkbox" name="terms" id="terms">
                        <label for="terms">I accept the <a href="/terms">terms and conditions</a></label>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <div class="error_box hidden">
        <img src="media/svg/error.svg" alt="" />
        <p id="error_msg">Something went wrong</p>
      </div>
</body>
<script>
     const error = document.getElementById("error_msg"); // use getElementById instead
      const box = document.querySelector(".error_box"); // use querySelector instead
      function close() {
        setTimeout(() => {
          box.classList.add("hidden");
        }, 2000);
      }
      function submit_form() {
        const TXNId = document.getElementById("Id").value;
        const c_TXNId = document.getElementById("cId").value;
        const termsCheckbox = document.getElementById("terms");

        if (!TXNId) {
          error.innerText = "Transition Id is required";
          box.classList.remove("hidden");
          close();
        } else if (!c_TXNId) {
          error.innerText = "Please confirm Transition Id";

          box.classList.remove("hidden");
          close();
        }
         else if (TXNId != c_TXNId) {
          error.innerText = "Transition Id does not match";

          box.classList.remove("hidden");
          close();
        }

         else if (!termsCheckbox.checked) {
          error.innerText = "You must accept the terms and conditions";
          box.classList.remove("hidden");
          close();
        } else {
          document.querySelector(".form_box").submit();
        }
      }
</script>
</html>