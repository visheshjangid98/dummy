<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support - Trace MC</title>
    <link rel="icon" type="image/png" href="media/favicon.png">
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/support.css">
</head>
<body>
    <%- include('components/navbar', { user: typeof user !== 'undefined' ? user : null }) %>
    
    <main class="main-content">
        <div class="support-container">
            <div class="support-header">
                <h1>Support Center</h1>
                <p>Need help? We're here to assist you with any questions or issues.</p>
            </div>
            
            <div class="support-content">
                <form class="support-form" action="/support-send" method="post" novalidate>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mcName" class="form-label">Minecraft Username</label>
                            <input
                                type="text"
                                id="mcName"
                                name="mcName"
                                class="form-input"
                                required
                                pattern="[a-zA-Z0-9]{3,16}"
                                placeholder="Your Minecraft username"
                            />
                        </div>
                        
                        <div class="form-group">
                            <label for="dcName" class="form-label">Discord Username</label>
                            <input
                                type="text"
                                id="dcName"
                                name="dcName"
                                class="form-input"
                                placeholder="Your Discord username (optional)"
                            />
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="email" class="form-label">Email Address</label>
                        <input
                            type="email"
                            id="email"
                            name="email"
                            class="form-input"
                            required
                            placeholder="your.email@example.com"
                        />
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="category" class="form-label">Support Category</label>
                            <div class="select-wrapper">
                                <select id="category" name="c" class="form-select" required>
                                    <option value="">Select a category</option>
                                    <option value="general">General Support</option>
                                    <option value="purchase">Purchase Support</option>
                                    <option value="bug">Bug Report</option>
                                    <option value="suggestion">Suggestion</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="topic" class="form-label">Topic</label>
                            <input
                                type="text"
                                id="topic"
                                name="topic"
                                class="form-input"
                                placeholder="Brief topic description"
                            />
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="description" class="form-label">Description</label>
                        <textarea
                            id="description"
                            name="Description"
                            class="form-textarea"
                            rows="6"
                            required
                            placeholder="Please describe your issue or question in detail..."
                        ></textarea>
                    </div>
                    
                    <button type="button" class="btn btn-primary support-btn" onclick="submit_form()">
                        Submit Support Request
                    </button>
                </form>
            </div>
        </div>
    </main>
    
    <div class="alert alert-error support-alert hidden" id="error-alert">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span id="error_msg">Something went wrong</span>
    </div>
    
    <script>
        const errorMsg = document.getElementById("error_msg");
        const errorAlert = document.getElementById("error-alert");
        
        function close() {
            setTimeout(() => {
                errorAlert.classList.add("hidden");
            }, 3000);
        }
        
        function submit_form() {
            const mcName = document.getElementById("mcName").value;
            const email = document.getElementById("email").value;
            const category = document.getElementById("category").value;
            const description = document.getElementById("description").value;

            if (!mcName) {
                errorMsg.textContent = "Minecraft username is required";
                errorAlert.classList.remove("hidden");
                close();
            } else if (mcName.length < 3) {
                errorMsg.textContent = "Username is too short";
                errorAlert.classList.remove("hidden");
                close();
            } else if (!email) {
                errorMsg.textContent = "Email is required";
                errorAlert.classList.remove("hidden");
                close();
            } else if (email.indexOf("@") === -1 || email.indexOf(".") === -1) {
                errorMsg.textContent = "Please enter a valid email address";
                errorAlert.classList.remove("hidden");
                close();
            } else if (!category) {
                errorMsg.textContent = "Please select a support category";
                errorAlert.classList.remove("hidden");
                close();
            } else if (!description) {
                errorMsg.textContent = "Please describe your issue";
                errorAlert.classList.remove("hidden");
                close();
            } else {
                document.querySelector(".support-form").submit();
            }
        }
    </script>
</body>
</html>